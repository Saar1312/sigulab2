{{extend "layout.html"}}

{{block head}}
  
  <!-- DataTables -->
  <link href="{{=URL('static', 'plugins/datatables/jquery.dataTables.min.css')}}" rel="stylesheet" type="text/css" />
  <link href="{{=URL('static', 'plugins/datatables/buttons.bootstrap.min.css')}}" rel="stylesheet" type="text/css" />
  <link href="{{=URL('static', 'plugins/datatables/responsive.bootstrap.min.css')}}" rel="stylesheet" type="text/css" />

  <link rel="stylesheet" type="text/css" href="{{=URL('static', 'css/servicios_modal.css')}}">
  <link rel="stylesheet" href="{{=URL('static', 'css/servicios_listado.css')}}">
  <link rel="stylesheet" href="{{=URL('static', 'css/servicios_template_modal.css')}}">
  
  <script src="{{=URL('static', 'js/servicios_template_modal.js')}}"></script>

  <!-- Web2py JS - Especialmente para AJAX -->
  <script src="{{=URL('static', 'js/web2py.js')}}"></script>
  <style>
    .row{
      margin-right:0px!important;
    }
  </style>
{{end}}

{{block center}}
<!-- Breadcrumb de navegación -->
<nav class="navbar navbar-inverse navbar-fixed-top breadcrumbs">
  <div class="breadcrumb">
  <a class="breadcrumb-item" href="{{=URL('..', 'sigulab2')}}">Inicio</a>
  <a class="breadcrumb-item" href="{{=URL('..', 'sigulab2', 'servicios')}}">Servicios</a>
  <span class="breadcrumb-item active">Listado</span>
  </div>
</nav>
<!-- Fin del Breadcrumb de navegación -->

<!-- Inicio Boton Agregar Listado -->
<div class="container" id="containerAgregar">
	<div class="row">
		<div class="col-sm-6"></div>
		<div id="columnBotonAgregar" class="col-sm-6">
			<div class="col-sm-6"></div>
            {{if not(auth.has_membership(group_id="CLIENTE INTERNO")):}}
			<div class="col-sm-6">
                <!-- Boton que lleva al modal -->
              <button type="button" id="botonAgregar" class="btn botonesListado" data-toggle="modal" data-target="#addservice">Agregar Servicio</button>
            </div>
            {{pass}}
        </div>
	</div>
</div>
<!-- Fin Boton Agregar Listado -->

<!-- Inicio Listado -->
<div class="container">
<div class="row">
  <h3> Listado de Servicios </h3>

    <div id="buttons">
      <!-- Filtrado -->
        <button type="button" id="filtrar" onclick="mostrarFiltro()" class="btn btn-default buttons-pdf buttons-html5">Filtrado</button>
      <!-- Filtrado -->    
    </div>
    <br>

    <div class="table-responsive no-padding no-margin">
      <table id="datatable" class="table table-hover table-striped dt-responsive display tablaListado" cellspacing="0" width="100%">
        <thead>
            <tr id="titulosListado">
                <th class="camposTabla linksNombres">Categoría</th>
                <th class="camposTabla linksNombres">Tipo</th>
                <th class="camposTabla linksNombres">Nombre</th>
                <th class="camposTabla linksNombres">Dependencia</th>
                <th class="camposTabla linksNombres">U. de Adscripción</th>
                <th class="camposTabla linksNombres">Sede</th>
                {{if rol == 2:}}
                <th class="camposTabla linksNombres">Visibilidad</th>
                {{pass}}
            </tr>
        </thead>

        <tbody>
          {{for servicio in servicios:}}
            <tr>
                <td class="camposTabla">{{=servicio.nombre_categoria.upper()}}</td>
                <td class="camposTabla">{{=servicio.nombre_tipo.upper()}}</td>
                <td class="camposTabla"><a data-toggle="modal" data-target="#myModal" 
                  onclick="abrirFicha({{=servicio.id}});">{{=servicio.nombre.upper()}}
                </a></td>
                <td class="camposTabla">{{=servicio.seccion.upper()}}</td>
                <td class="camposTabla">{{=servicio.laboratorio.upper()}}</td>
                <td class="camposTabla">{{=servicio.sede.upper()}}</td>
                {{if rol == 2:}}
                <td class="camposTabla">{{if servicio.visibilidad:}}VISIBLE{{else:}}OCULTO{{pass}}</td>
                {{pass}}
            </tr>
          {{pass}}           
        </tbody>

        <tfoot id="collapseFiltros">
            <tr>
                <th class="camposTabla linksNombres">Categoría</th>
                <th class="camposTabla linksNombres">Tipo</th>
                <th class="camposTabla linksNombres">Nombre</th>
                <th class="camposTabla linksNombres">Dependencia</th>
                <th class="camposTabla linksNombres">U. de Adscripción</th>
                <th class="camposTabla linksNombres">Sede</th>
                {{if rol == 2:}}
                <th class="camposTabla linksNombres">Visibilidad</th>
                {{pass}}
            </tr>
        </tfoot>

      </table>
    </div>
  </div>
</div>  
<!-- Fin Listado --> 


<!-- Ajax abrirFicha-->
<input type="hidden" id="serv" name="serv" value="">

<!-- Inicio Modal ficha de Servicio -->
  <div id="myModal" class="modal fade" role="dialog">
    <div class="modal-dialog modal-lg">

      <!-- Modal content-->
      <div id="ficha" class="modal-content">
      </div>

    </div>
  </div>
<!-- Fin Modal ficha de servicio -->

<!-- Modal añadir un servicio -->
  <div class="modal fade" id="addservice" role="dialog">
    <div class="modal-dialog">

      <!-- Modal content-->
      <div class="modal-content">

        <!-- Modal Header -->
        <div class="modal-header addHeader">
          <div class="row addRow" id="rowHeader">
            <div class="col-sm-1" id="col1Header">
              <div class="container" id="plus">
                <h1 id="agregar">+</h1>
              </div>
            </div>
            <div class="col-sm-10" id="col11Header">
              <h4 class="modal-title" id="nuevoServicio">Nuevo Servicio
                <button type="button" class="close" data-dismiss="modal">&times;</button>
              </h4>
            </div>
          </div>
        </div>
        <!-- Fin Modal Header -->
        
        <!-- Modal Body -->
        <div class="modal-body addBody">
          <div class="row addRow">
            <div class="col-md-12 form-box">
                <form id="formularioCarga" class="registration-form" method="post">

                    <!-- Primer Paso -->
                    <fieldset class="formField">
                      <div class="form-bottom" data-step="1" data-title="Primer Paso">
                        <!-- Aqui va la barra lateral -->
                            <div class="col-sm-1 col1Body">
                              <span class="step activePass">1</span>
                              <span class="step">2</span>
                              <span class="step">3</span>
                              <span class="step">4</span>             
                              <span class="step">5</span>
                              <span class="step">6</span> 
                            </div>
                          <!-- Aqui va la informacion -->
                        <div class="col-sm-11 col11Body">
                          <h4 class="titulosForm">Datos Básicos</h4>                
                          <label>Campos marcados con * son obligatorios.</label>
                            <div class="form-group">
                              <input type="text" class="form-control" name="nombreServicio" placeholder="Nombre*" required>
                            </div>
                            <div class="form-group">
                              <select class="form-control" type="select" id="sel1" name="categoriaServicio" required>
                                <option value="" selected hidden >Categoria*</option>
		                        {{for categoria in categorias:}}

		                        <option value="{{=categoria.id}}">{{=categoria.nombre}}</option>
		                        {{pass}} 
                              </select>
                            </div>
                            <div class="form-group">
                              <select class="form-control" type="select" id="sel2" name="tipoServicio" required>
                                <option value="" selected hidden >Tipo*</option>
		                        {{for tipo in tipos:}}

		                        <option value="{{=tipo.id}}">{{=tipo.nombre}}</option>
		                        {{pass}}
                              </select>
                            </div>
                            <div class="form-group" style="padding-bottom: 50px">
                              <h6 id="funcion" style="margin-top: 25px; font-size: 15px;">Función*</h6>
                              <div class="checkbox">
                                <label><input type="checkbox" id="checkbox1" name="docenciaServicio" value="True" >Docencia</label>
                              </div>
                              <div class="checkbox">
                                <label><input type="checkbox" id="checkbox2" name="investigacionServicio" value="True" >Investigación</label>
                              </div>
                              <div class="checkbox">
                                <label><input type="checkbox" id="checkbox3" name="extensionServicio" value="True" >Extensión</label>
                              </div>
                              <div class="checkbox">
                                <label><input type="checkbox" id="checkbox4" name="gestionServicio" value="True" >Gestión</label>
                              </div>
                            </div>
                        </div>
                      </div>
                      <button type="button" class="btn btn-next botonForm">Siguiente</button>
                    </fieldset>
                    <!-- Fin Primer Paso -->
                    
                    <!-- Segundo Paso -->
                    <fieldset class="formField">
                        <div class="form-bottom" data-step="2" data-title="Segundo Paso">
                          <!-- Aqui va la barra lateral -->
                          <div class="col-sm-1 col1Body">
                            <span class="step ready">1</span>
                            <span class="step activePass">2</span>
                            <span class="step">3</span>
                            <span class="step">4</span> 
                            <span class="step">5</span>
                            <span class="step">6</span> 
                          </div>

                          <!-- Aqui va la informacion -->
                          <div class="col-sm-11 col11Body">
                          <h4 class="titulosForm">Datos Básicos</h4>
                            <div class="form-group">
                              <input type="text" class="form-control" id="objetivo" name="objetivoServicio" placeholder="Objetivo*">
                            </div>
                            <div class="form-group">
                              <input type="text" class="form-control" id="alcance" name="alcanceServicio" placeholder="Alcance*">
                            </div>
                            <div class="form-group">
                              <input type="text" class="form-control" id="metodo" name="metodoServicio" placeholder="Método*">
                            </div>
                            <div class="form-group">
                              <input type="text" class="form-control" id="rango" name="rangoServicio" placeholder="Rango*">
                            </div>
                            <div class="form-group">
                              <input type="text" class="form-control" id="incertidumbre" name="incertidumbreServicio" placeholder="Incertidumbre*">
                            </div>

                            <div class="form-group" >
                              <h6 id="ambito" style="margin-top: 25px; font-size: 15px;">Ámbito de aplicación*</h6>

                              <div class="checkbox">
                                <label><input type="checkbox" id="checkbox_ambito_in_situ" name="ambito_in_situ" value="True">In Situ</label>
                              </div>
                              
                              <div class="checkbox">
                                <label><input type="checkbox" id="checkbox_ambito_en_campo" name="ambito_en_campo" value="True">En Campo</label>
                              </div>
                              
                              <div class="checkbox">
                                <label><input type="checkbox" id="checkbox_ambito_otro" name="ambito_otro" value="True" onclick="cambiar_estado_detalle_ambito($(this).prop('checked'), $(this).attr('id'))">Otro</label>
                              </div>

                              <input type="text" class="form-control" style="display:none;" id="input_ambito_otro_detalle" name="ambito_otro_detalle" placeholder="Otro, Especifique:*" value=" ">
                          </div>

                          </div>
                        </div>
                        <button type="button" class="btn btn-previous botonForm">Anterior</button>
                        <button type="button" class="btn btn-next botonForm">Siguiente</button>
                    </fieldset>
                    <!-- Fin Segundo Paso -->

                    <!-- Tercer Paso -->
                    <fieldset class="formField">
                      <div class="form-bottom" data-step="3" data-title="Tercer Paso">
                        <!-- Aqui va la barra lateral -->
                        <div class="col-sm-1 col1Body">
                          <span class="step ready">1</span>
                          <span class="step ready">2</span>
                          <span class="step activePass">3</span>
                          <span class="step">4</span> 
                          <span class="step">5</span>
                          <span class="step">6</span> 
                        </div>
                        
                        <!-- Aqui va la informacion -->
                        <div class="col-sm-11 col11Body">
                        <h4 class="titulosForm">Responsable y Área</h4>

                          <!--<div class="form-group">
                            <select class="form-control" id="sel10" name="responsableServicio" required>
                              <option value="1" selected hidden>Responsable</option>
                                {for responsable in responsables:}}
                                <option id="responsablechoice" value="{=responsable.id}}">{=responsable.f_nombre}} | {=responsable.f_email}}</option>
                              {pass}}
                            </select>                            
                          </div>-->

                          <div class="form-group">
                            <select class="form-control" type="select" id="sel6" onchange="getAdscripcion(); getDependencia(); getUbicacion(); getResponsable();" name="sedeServicio" required>
                              <option value="" selected hidden >Sede&#42;</option>
		                      {{for sede in sedes:}}
		                      <option id="sedechoice" value="{{=sede.id}}">{{=sede.nombre}}</option>
		                      {{pass}}
                            </select>
                          </div>

	                      <div id="adscripciondiv" class="form-group">
	                    
	                      </div>

	                      <div id="dependenciadiv" class="form-group">
	                    
	                      </div>
	                    
	                      <div id="ubicaciondiv" class="form-group">
	                    
	                      </div>

                          <div id="responsablediv" class="form-group">

	                      </div>

                        </div>
                      </div> 
                      <button type="button" class="btn btn-previous botonForm">Anterior</button>
                      <button type="button" class="btn btn-next botonForm">Siguiente</button>
                    </fieldset>
                    <!-- Fin Tercer Paso -->

                    <!-- Cuarto Paso -->
                    <fieldset class="formField">
                      <div class="form-bottom" data-step="4" data-title="Cuarto Paso">
                      <!-- Aqui va la barra lateral -->
                        <div class="col-sm-1 col1Body">
                          <span class="step ready">1</span>
                          <span class="step ready">2</span>
                          <span class="step ready">3</span>
                          <span class="step activePass">4</span> 
                          <span class="step">5</span>
                          <span class="step">6</span> 
                        </div>

                      <!-- Aqui va la informacion -->
                        <div class="col-sm-11 col11Body" >
                        <h4 class="titulosForm">Especificaciones</h4>
                          <div class="form-group">
                            <input type="text" class="form-control" id="item_ensayar" name="itemServicio" placeholder="Item a ensayar*">
                          </div>
                          <br>
                          <div class="form-group">
                            <textarea class="form-control" id="requisitos" name="requisitosServicio" placeholder="Requisitos" ></textarea>
                          </div>
                          
                          <div class="form-group"  style="padding-bottom: 50px">
                            <h6 id="producto" style="margin-top: 25px; font-size: 15px;">Producto*</h6>
                            <div class="checkbox">
                              <label><input type="checkbox" id="checkbox5" name="entregadeResultadosServicio" value="True" >Entrega de Resultados</label>
                            </div>
                            <div class="checkbox">
                              <label><input type="checkbox" id="checkbox6" name="informedeEnsayoCalibracionServicio" value="True" >Informe de ensayo o calibración</label>
                            </div>
                            <div class="checkbox">
                              <label><input type="checkbox" id="checkbox7" name="certificadoConformidadServicio" value="True" >Certificado de conformidad del producto (ensayado o calibrado)</label>
                            </div>
                            <div class="checkbox">
                              <label><input type="checkbox" id="checkbox8" name="certificadoCalibracionServicio" value="True" >Certificado de calibración</label>
                            </div>
                            <div class="checkbox">
                              <label><input type="checkbox" id="checkbox9" name="otroServicio" value="True" >Otro</label>
                            </div>
                          </div>
                        </div>
                      </div>
                    
                      <button type="button" class="btn btn-previous botonForm">Anterior</button>
                      <button type="button" class="btn btn-next botonForm">Siguiente</button>                     
                    </fieldset>
                    <!-- Fin Cuarto Paso -->

                    <!-- Quinto Paso -->
                    <fieldset class="formField">
                      <div class="form-bottom" data-step="5" data-title="Quinto Paso">
                      <!-- Aqui va la barra lateral -->
                        <div class="col-sm-1 col1Body">
                          <span class="step ready">1</span>
                          <span class="step ready">2</span>
                          <span class="step ready">3</span>
                          <span class="step ready">4</span> 
                          <span class="step activePass">5</span>
                          <span class="step">6</span> 
                        </div>

                      <!-- Aqui va la informacion -->
                        <div class="col-sm-11 col11Body" >

                        <h4 class="titulosForm">Recursos</h4>

<!--                           <div class="form-group">
                            <input type="text" class="form-control" id="item_ensayar" name="itemServicio" placeholder="Item a ensayar*">
                          </div>

                          <div class="form-group">
                            <textarea class="form-control" id="requisitos" name="requisitosServicio" placeholder="Requisitos" ></textarea>
                          </div> -->

                          <!-- Personal Requerido -->
                          <div class="form-group" >
                              <h6 id="" style="margin-top: 25px; font-size: 15px;">Personal Requerido*</h6>

                              <div class="checkbox">
                                <label><input type="checkbox" id="" name="per_tecnico" value="True">Técnico</label>
                              </div>
                              
                              <div class="checkbox">
                                <label><input type="checkbox" id="" name="per_supervisor" value="True">Supervisor</label>
                              </div>

                              <div class="checkbox">
                                <label><input type="checkbox" id="" name="per_tesista" value="True">Tesista</label>
                              </div>

                              <div class="checkbox">
                                <label><input type="checkbox" id="" name="per_pasante" value="True">Pasante</label>
                              </div>

                              <div class="checkbox">
                                <label><input type="checkbox" id="" name="per_preparador" value="True">Preparador</label>
                              </div>

                              <div class="checkbox">
                                <label><input type="checkbox" id="" name="per_obrero" value="True">Obrero</label>
                              </div>
                              
                              <div class="checkbox">
                                <label><input type="checkbox" id="checkbox_per_otro" name="per_otro" value="True" onclick="cambiar_estado_detalle_ambito($(this).prop('checked'), $(this).attr('id'))">Otro</label>
                              </div>

                              <input type="text" class="form-control" style="display:none;" id="input_per_otro_detalle" name="per_otro_detalle" placeholder="Otro, especifique:*" value=" ">
                          </div>

                          <!-- Equipo que presta servicio -->
                          <div class="form-group">
                            <label>Equipos Requeridos*</label>
                            <textarea class="form-control" name="equipo_presta_servicio" placeholder="Nombre / Bien Nacional" required></textarea>
                          </div>
                        </div>
                      </div>
                      <button type="button" class="btn btn-previous botonForm">Anterior</button>
                      <button type="button" class="btn btn-next botonForm">Siguiente</button>                     
                    </fieldset>
                    <!-- Fin Quinto Paso -->

                    <!-- Sexto Paso -->
                    <fieldset class="formField">
                      <div class="form-bottom" data-step="6" data-title="Sexto Paso">
                      <!-- Aqui va la barra lateral -->
                        <div class="col-sm-1 col1Body">
                          <span class="step ready">1</span>
                          <span class="step ready">2</span>
                          <span class="step ready">3</span>
                          <span class="step ready">4</span>
                          <span class="step ready">5</span> 
                          <span class="step activePass">6</span>
                        </div>

                      <!-- Aqui va la informacion -->
                        <div class="col-sm-11 col11Body" >

                        <h4 class="titulosForm">Recursos Continuación</h4>

                          <!-- Insumos -->
                          <div class="form-group">
                            <label>Insumos*</label>
                            <textarea class="form-control" name="insumos_servicio" placeholder="Materiales que se requieren para la ejecución del servicio" required></textarea>
                          </div>

                          <!-- Condicion Ambiental -->
                          <div class="form-group" >
                              <h6 id="" style="margin-top: 25px; font-size: 15px;">Condicion Ambiental*</h6>

                              <div class="radio">
                                <label><input type="radio" id="radio_condicion_ambiental" name="condicion_ambiental" value="True" onclick="cambiar_estado_condicion_ambiental('True', $(this).attr('id'))">Si requiere</label>
                              </div>
                              
                              <div class="radio">
                                <label><input type="radio" id="radio_condicion_ambiental" name="condicion_ambiental" value="False" onclick="cambiar_estado_condicion_ambiental('False', $(this).attr('id'))">No requiere</label>
                              </div>

                              <input type="text" class="form-control" style="display:none;" id="input_radio_condicion_ambiental" name="condicion_ambiental_detalle" placeholder="Si requiere, especifique:*" value=" ">
                          </div>

                        </div>
                      </div>
                      <button type="button" class="btn btn-previous botonForm">Anterior</button>
                      <button type="submit" form="formularioCarga" id="submit" class="btn btn-submit botonForm">Agregar</button>                      
                    </fieldset>
                    <!-- Fin Sexto Paso -->

                </form>
            </div>
          </div>               


        </div>
      </div>

    </div>
  </div>

<!-- Fin Modal Agregar Servicio -->

<button class="hidden" type="hidden" id="edito" data-toggle="modal" data-target="#editservice"></button>

<!-- Inicio Modal Editar Servicio -->
{{if len(editar) != 0:}}
    <script>
        $(document).ready(function(){
            document.getElementById("edito").click();
        });

    </script>

<!-- Modal editar un servicio -->
  <div class="modal fade" id="editservice" role="dialog">
    <div class="modal-dialog">

      <!-- Modal content-->
      <div class="modal-content">

        <!-- Modal Header -->
        <div class="modal-header addHeader">
          <div class="row addRow" id="rowHeader">
            <div class="col-sm-1" id="col1Header">
              <div class="container" id="plus">
                <h1 id="agregar">+</h1>
              </div>
            </div>
            <div class="col-sm-11" id="col11Header">
              <h4 class="modal-title" id="nuevoServicio">Editar Servicio</h4>
            </div>
          </div>
        </div>
        <!-- Fin Modal Header -->
        
        <!-- Modal Body -->
        <div class="modal-body addBody">
          <div class="row addRow">
            <div class="col-md-12 form-box">
                <form id="formularioEdit" class="registration-form" method="post">

                    <!-- Primer Paso -->
                    <fieldset class="formField">
                      <div class="form-bottom" data-step="1" data-title="Primer Paso">
                        <!-- Aqui va la barra lateral -->
                        <div class="col-sm-1 col1Body">
                          <span class="step activePass">1</span>
                          <span class="step">2</span>
                          <span class="step">3</span>
                          <span class="step">4</span>             
                          <span class="step">5</span>
                          <span class="step">6</span>              
                        </div>
                        <!-- Aqui va la informacion -->
                        <div class="col-sm-11 col11Body">
                          <h4 class="titulosForm">Datos Básicos</h4>                
                            <div class="form-group">
                              <input type="text" class="form-control" name="nombreServicio" value="{{=editar[0].nombre}}" required>
                            </div>
                            <div class="form-group">
                              <select class="form-control" id="sel1.1" name="categoriaServicio" required>
                                <option value="{{=editar[0].categoria}}" selected hidden>{{=db(db.categorias_servicios.id == editar[0].categoria).select(db.categorias_servicios.nombre)[0].nombre}}</option>
		                        {{for categoria in categorias:}}
		                        <option value="{{=categoria.id}}">{{=categoria.nombre}}</option>
		                        {{pass}} 
                              </select>
                            </div>
                            <div class="form-group">
                              <select class="form-control" type="select" id="sel2.1" name="tipoServicio" required>
                                <option value="{{=editar[0].tipo}}" selected hidden >{{=db(db.tipos_servicios.id == editar[0].tipo).select(db.tipos_servicios.nombre)[0].nombre}}</option>
		                        {{for tipo in tipos:}}
		                        <option value="{{=tipo.id}}">{{=tipo.nombre}}</option>
		                        {{pass}}
                              </select>
                            </div>
                            <div class="form-group">
                              <h6 id="funcion_editar" style="margin-top: 25px; font-size: 15px;">Función*</h6>
                              <div class="checkbox">
                                <label><input type="checkbox" id="checkbox1e" name="docenciaServicio" value="True" {{if editar[0].docencia:}} checked {{pass}}>Docencia</label>
                              </div>
                              <div class="checkbox">
                                <label><input type="checkbox" id="checkbox2e" name="investigacionServicio" value="True" {{if editar[0].investigacion:}} checked {{pass}}>Investigación</label>
                              </div>
                              <div class="checkbox">
                                <label><input type="checkbox" id="checkbox3e" name="extensionServicio" value="True" {{if editar[0].extension:}} checked {{pass}}>Extensión</label>
                              </div>
                              <div class="checkbox" style="padding-bottom: 50px">
                                <label><input type="checkbox" id="checkbox4e" name="gestionServicio" value="True" {{if editar[0].gestion:}} checked {{pass}}>Gestión</label>
                              </div>
                            </div>
                        </div>
                      </div>
                      <button type="button" class="btn btn-next edit botonForm" >Siguiente</button>
                    </fieldset>
                    <!-- Fin Primer Paso -->
                    
                    <!-- Segundo Paso -->
                    <fieldset class="formField">
                        <div class="form-bottom" data-step="2" data-title="Segundo Paso">
                          <!-- Aqui va la barra lateral -->
                          <div class="col-sm-1 col1Body">
                            <span class="step">1</span>
                            <span class="step activePass">2</span>
                            <span class="step">3</span>
                            <span class="step">4</span> 
                            <span class="step">5</span>
                            <span class="step">6</span> 
                          </div>

                          <!-- Aqui va la informacion -->
                          <div class="col-sm-11 col11Body">
                          <h4 class="titulosForm">Datos Básicos</h4>
                            <div class="form-group">
                              <input type="text" class="form-control" id="objetivo" name="objetivoServicio" value="{{=editar[0].objetivo}}">
                            </div>
                            <div class="form-group">
                              <input type="text" class="form-control" id="alcance" name="alcanceServicio" value="{{=editar[0].alcance}}">
                            </div>
                            <div class="form-group">
                              <input type="text" class="form-control" id="metodo" name="metodoServicio" value="{{=editar[0].metodo}}">
                            </div>
                            <div class="form-group">
                              <input type="text" class="form-control" id="rango" name="rangoServicio" value="{{=editar[0].rango}}">
                            </div>
                            <div class="form-group">
                              <input type="text" class="form-control" id="incertidumbre" name="incertidumbreServicio" value="{{=editar[0].incertidumbre}}">
                            </div>

                            <div class="form-group">
                              <h6 id="ambito_editar" style="margin-top: 25px; font-size: 15px;">Ámbito de Aplicación:*</h6>

                              <div class="checkbox">
                                <label><input type="checkbox" id="editar_checkbox_ambito_in_situ" name="ambito_in_situ" value="True" {{if editar[0].ambito_in_situ:}} checked {{pass}}>In Situ</label>
                              </div>

                              <div class="checkbox">
                                <label><input type="checkbox" id="editar_checkbox_ambito_en_campo" name="ambito_en_campo" value="True" {{if editar[0].ambito_en_campo:}} checked {{pass}}>En Campo</label>
                              </div>

                              <div class="checkbox">
                                <label><input type="checkbox" id="editar_checkbox_ambito_otro" name="ambito_otro" value="True" onclick="cambiar_estado_detalle_ambito($(this).prop('checked'), $(this).attr('id'))" {{if editar[0].ambito_otro:}} checked {{pass}}>Otro</label>
                              </div>
                              
                              <div class="form-group">
                                <input type="text" {{if not editar[0].ambito_otro:}} style="display:none;" placeholder="Otro, Especifique:*" value=" "{{else:}} value="{{=editar[0].ambito_otro_detalle}}"{{pass}} class="form-control" id="editar_input_ambito_otro_detalle" name="ambito_otro_detalle" >
                              </div>
                          </div>

                          </div>
                        </div>
                        <button type="button" class="btn btn-previous botonForm">Anterior</button>
                        <button type="button" class="btn btn-next botonForm">Siguiente</button>
                    </fieldset>
                    <!-- Fin Segundo Paso -->

                    <!-- Tercer Paso -->
                    <fieldset class="formField">
                      <div class="form-bottom" data-step="3" data-title="Tercer Paso">
                        <!-- Aqui va la barra lateral -->
                        <div class="col-sm-1 col1Body">
                          <span class="step">1</span>
                          <span class="step">2</span>
                          <span class="step activePass">3</span>
                          <span class="step">4</span>
                          <span class="step">5</span>
                          <span class="step">6</span>  
                        </div>
                        
                        <!-- Aqui va la informacion -->
                        <div class="col-sm-11 col11Body">
                        <h4 class="titulosForm">Responsable y Área</h4>

                          <div class="form-group">

                              <select class="form-control" id="sel6-edit"  onchange="getAdscripcionEdit();" name="sedeServicio" required>
                                  <option value="{{=request.post_vars.sedeIdFicha}}" selected hidden >{{=request.post_vars.sedeFicha}}</option>
                                  {{for sede in sedes:}}
                                  <option id="sedechoice" value="{{=sede.id}}">{{=sede.nombre}}</option>
                                  {{pass}}
                              </select>
                          </div>


	                      <div id="adscripciondiv-edit" class="form-group">
                              <select class="form-control" id="sel4-edit" onclick="getAdscripcionEdit();" name="laboratorioServicio" required>
                                  <option value="{{=request.post_vars.adscripcionIdFicha}}" selected hidden >{{=request.post_vars.adscripcionFicha}}</option>
                              </select>
	                      </div>

	                      <div id="dependenciadiv-edit" class="form-group">
	                        <select class="form-control" id="sel3-edit" onclick="getDependenciaEdit();" name="dependenciaServicio" required>
							                 <option value="{{=request.post_vars.dependenciaIdFicha}}" selected hidden>{{=request.post_vars.dependenciaFicha}} </option>
							             </select>
	                      </div>
	                    
	                      <div id="ubicaciondiv-edit" class="form-group">
						              <select class="form-control" id="sel5-edit" onclick="getUbicacionEdit();" name="ubicacionServicio" required>
 							              <option value="{{=request.post_vars.ubicacionIdFicha}}" selected hidden>{{=request.post_vars.ubicacionFicha}}</option>
 							            </select>	                    
	                      </div>

                        <div id="responsablediv-edit" class="form-group">
						              <select class="form-control" id="selresp-edit" onclick="getResponsableEdit();" name="responsableServicio" required>
 							              <option value="{{=request.post_vars.responsableIdFicha}}" selected hidden>{{=request.post_vars.responsableNombreFicha}} | {{=request.post_vars.responsableEmailFicha}}</option>
 							            </select>
	                      </div>

                        </div>
                      </div> 
                      <button type="button" class="btn btn-previous botonForm">Anterior</button>
                      <button type="button" class="btn btn-next botonForm">Siguiente</button>
                    </fieldset>
                    <!-- Fin Tercer Paso -->

                    <!-- Cuarto Paso -->
                    <fieldset class="formField">
                      <div class="form-bottom" data-step="4" data-title="Cuarto Paso">
                      <!-- Aqui va la barra lateral -->
                        <div class="col-sm-1 col1Body">
                          <span class="step">1</span>
                          <span class="step">2</span>
                          <span class="step">3</span>
                          <span class="step activePass">4</span>
                          <span class="step">5</span>
                          <span class="step">6</span>  
                        </div>

                      <!-- Aqui va la informacion -->
                        <div class="col-sm-11 col11Body" >
                        <h4 class="titulosForm">Especificaciones</h4>
                          <div class="form-group">
                            <input type="text" class="form-control" id="item" name="itemServicio" value="{{=editar[0].item_ensayar}}" required>
                          </div>
                          <div class="form-group">
                            <textarea class="form-control" id="requisitos" name="requisitosServicio" value="{{=editar[0].requisitos}}">{{=editar[0].requisitos}}</textarea>
                          </div>
                          <div class="form-group">
                            <h6 id="funcion_editar" style="margin-top: 25px; font-size: 15px;">Producto</h6>
                            <div class="checkbox">
                              <label><input type="checkbox" id="#checkbox1e" name="entregadeResultadosServicio" value="True" {{if editar[0].entregaResultados:}} checked {{pass}}>Entrega de Resultados</label>
                            </div>
                            <div class="checkbox">
                              <label><input type="checkbox" id="#checkbox6e" name="informedeEnsayoCalibracionServicio" value="True" {{if editar[0].ensayoCalibracion:}} checked {{pass}}>Informe de ensayo o calibración</label>
                            </div>
                            <div class="checkbox">
                              <label><input type="checkbox" id="#checkbox7e" name="certificadoConformidadServicio" value="True" {{if editar[0].certificadoConformidadProducto:}} checked {{pass}}>Certificado de conformidad del producto (ensayado o calibrado)</label>
                            </div>
                            <div class="checkbox">
                              <label><input type="checkbox" id="#checkbox8e" name="certificadoCalibracionServicio" value="True" {{if editar[0].certificadoCalibracion:}} checked {{pass}}>Certificado de calibración</label>
                            </div>
                            <div class="checkbox">
                              <label><input type="checkbox" id="#checkbox9e" name="otroServicio" value="True" {{if editar[0].otro:}} checked {{pass}}>Otro</label>
                            </div>
                          </div>
                        </div>
                      </div>
                      
                      <button type="button" class="btn btn-previous botonForm">Anterior</button>
                      <button type="button" class="btn btn-next botonForm">Siguiente</button>

                    </fieldset>
                    <!-- Fin Cuarto Paso -->

                    <!-- Quinto Paso -->
                    <fieldset class="formField">
                      <div class="form-bottom" data-step="5" data-title="Quinto Paso">
                      <!-- Aqui va la barra lateral -->
                        <div class="col-sm-1 col1Body">
                          <span class="step ready">1</span>
                          <span class="step ready">2</span>
                          <span class="step ready">3</span>
                          <span class="step ready">4</span> 
                          <span class="step activePass">5</span>
                          <span class="step">6</span> 
                        </div>

                      <!-- Aqui va la informacion -->
                        <div class="col-sm-11 col11Body" >

                        <h4 class="titulosForm">Recursos</h4>

<!--                           <div class="form-group">
                            <input type="text" class="form-control" id="item_ensayar" name="itemServicio" placeholder="Item a ensayar*">
                          </div>

                          <div class="form-group">
                            <textarea class="form-control" id="requisitos" name="requisitosServicio" placeholder="Requisitos" ></textarea>
                          </div> -->

                          <!-- Personal Requerido -->
                          <div class="form-group" >
                              <h6 id="" style="margin-top: 25px; font-size: 15px;">Personal Requerido*</h6>

                              <div class="checkbox">
                                <label><input type="checkbox" id="" name="per_tecnico" value="True"{{if editar[0].per_tecnico:}} checked {{pass}}>Técnico</label>
                              </div>
                              
                              <div class="checkbox">
                                <label><input type="checkbox" id="" name="per_supervisor" value="True" {{if editar[0].per_supervisor:}} checked {{pass}}>Supervisor</label>
                              </div>

                              <div class="checkbox">
                                <label><input type="checkbox" id="" name="per_tesista" value="True" {{if editar[0].per_tesista:}} checked {{pass}}>Tesista</label>
                              </div>

                              <div class="checkbox">
                                <label><input type="checkbox" id="" name="per_pasante" value="True" {{if editar[0].per_pasante:}} checked {{pass}}>Pasante</label>
                              </div>

                              <div class="checkbox">
                                <label><input type="checkbox" id="" name="per_preparador" value="True" {{if editar[0].per_preparador:}} checked {{pass}}>Preparador</label>
                              </div>

                              <div class="checkbox">
                                <label><input type="checkbox" id="" name="per_obrero" value="True" {{if editar[0].per_obrero:}} checked {{pass}}>Obrero</label>
                              </div>
                              

                              <div class="checkbox">
                                <label><input type="checkbox" id="editar_checkbox_per_otro" name="per_otro" value="True" onclick="cambiar_estado_detalle_ambito($(this).prop('checked'), $(this).attr('id'))" {{if editar[0].per_otro:}} checked {{pass}}>Otro</label>
                              </div>

                              <input type="text" class="form-control" name="per_otro_detalle" {{if not editar[0].per_otro:}} style="display:none;" placeholder="Otro, Especifique:*" value=" " {{else:}} value="{{=editar[0].per_otro_detalle}}"{{pass}}  id="editar_input_per_otro_detalle">
                          </div>

                          <!-- Equipo que presta servicio -->
                          <div class="form-group">
                            <label>Equipos Requeridos*</label>
                            <textarea class="form-control" name="equipo_presta_servicio" value="{{=editar[0].equipo_presta_servicio}}" required>{{=editar[0].equipo_presta_servicio}}</textarea>
                          </div>
                        </div>
                      </div>
                      <button type="button" class="btn btn-previous botonForm">Anterior</button>
                      <button type="button" class="btn btn-next botonForm">Siguiente</button>                     
                    </fieldset>
                    <!-- Fin Quinto Paso -->

                    <!-- Sexto Paso -->
                    <fieldset class="formField">
                      <div class="form-bottom" data-step="6" data-title="Sexto Paso">
                      <!-- Aqui va la barra lateral -->
                        <div class="col-sm-1 col1Body">
                          <span class="step ready">1</span>
                          <span class="step ready">2</span>
                          <span class="step ready">3</span>
                          <span class="step ready">4</span>
                          <span class="step ready">5</span> 
                          <span class="step activePass">6</span>
                        </div>

                      <!-- Aqui va la informacion -->
                        <div class="col-sm-11 col11Body" >

                        <h4 class="titulosForm">Recursos Continuación</h4>

                          <!-- Insumos -->
                          <div class="form-group">
                            <label>Insumos*</label>
                            <textarea class="form-control" name="insumos_servicio" value="{{=editar[0].insumos_servicio}}" required>{{=editar[0].insumos_servicio}}</textarea>
                          </div>

                          <!-- Condicion Ambiental -->
                          <div class="form-group" >
                              <h6 id="" style="margin-top: 25px; font-size: 15px;">Condicion Ambiental*</h6>

                              <div class="radio">
                                <label><input type="radio" id="editar_radio_condicion_ambiental" name="condicion_ambiental" value="True" onclick="cambiar_estado_condicion_ambiental('True', $(this).attr('id'))" {{if editar[0].condicion_ambiental:}} checked {{pass}}>Si requiere</label>
                              </div>
                              
                              <div class="radio">
                                <label><input type="radio" id="editar_radio_condicion_ambiental" name="condicion_ambiental" value="False" onclick="cambiar_estado_condicion_ambiental('False', $(this).attr('id'))" {{if not editar[0].condicion_ambiental:}} checked {{pass}}>No requiere</label>
                              </div>

                              <input type="text" class="form-control" id="editar_input_radio_condicion_ambiental" name="condicion_ambiental_detalle" {{if not editar[0].condicion_ambiental:}} style="display:none;" placeholder="Si requiere, especifique:" value=" " {{else:}} value="{{=editar[0].condicion_ambiental_detalle}}"{{pass}}>
                          </div>

                        </div>
                      </div>
                      <button type="button" class="btn btn-previous botonForm">Anterior</button>
                      <input type="hidden" name="idServicioEdit" value="{{=editar[0].id}}"></input>
                      <button type="submit" class="btn btn-submit botonForm" id="submit" form="formularioEdit" name="envio" value="edicion" >Guardar Cambios</button>                    
                    </fieldset>
                    <!-- Fin Sexto Paso -->
                    
                </form>
            </div>
          </div>               
        </div>
      </div>

    </div>
  </div>

<!-- Fin Modal Editar Servicio -->
{{pass}}
<!-- Ajax getLabs--> 
<input type="hidden" id="sede" name="sede" value="">
<!-- Ajax getSecc--> 
<input type="hidden" id="adscripcion" name="adscripcion" value="">
<!-- Ajax getUbic--> 
<input type="hidden" id="dependencia" name="dependencia" value="">
<!-- Ajax getResp--> 
<input type="hidden" id="ubicacion" name="ubicacion" value="">
<!-- Ajax getEspFis -->



<!-- Datatables-->
<script src="{{=URL('static', 'plugins/datatables/jquery.dataTables.min.js')}}"></script>
<script src="{{=URL('static', 'plugins/datatables/dataTables.bootstrap.js')}}"></script>
<script src="{{=URL('static', 'plugins/datatables/dataTables.buttons.min.js')}}"></script>
<script src="{{=URL('static', 'plugins/datatables/buttons.bootstrap.min.js')}}"></script>
<script src="{{=URL('static', 'plugins/datatables/jszip.min.js')}}"></script>
<script src="{{=URL('static', 'plugins/datatables/pdfmake.min.js')}}"></script>
<script src="{{=URL('static', 'plugins/datatables/vfs_fonts.js')}}"></script>
<script src="{{=URL('static', 'plugins/datatables/buttons.html5.min.js')}}"></script>
<script src="{{=URL('static', 'plugins/datatables/buttons.print.min.js')}}"></script>
<script src="{{=URL('static', 'plugins/datatables/dataTables.responsive.min.js')}}"></script>
<script src="{{=URL('static', 'plugins/datatables/responsive.bootstrap.min.js')}}"></script>



<!-- Datatable init js -->
<script src="{{=URL('static', 'plugins/datatables/datatables.init.js')}}"></script>
<script>

  var filtros = false;

  $(document).ready(function() {
      // Setup - add a text input to each footer cell
      $('#datatable tfoot th').each( function () {
          var title = $(this).text();
          $(this).html( '<input type="text" placeholder="Filtro" />' );
      } );
   
      // DataTable
      var table = $('#datatable').DataTable();
   
      // Apply the search
      table.columns().every( function () {
          var that = this;
   
          $( 'input', this.footer() ).on( 'keyup change', function () {
              if ( that.search() !== this.value ) {
                  that
                      .search( this.value )
                      .draw();
              }
          } );
      } );

      $('#datatable tfoot tr').appendTo('#datatable thead');
      $("#datatable thead tr").not("#titulosListado").css("display","none");
  } );

  function mostrarFiltro() {
      if (filtros){
        $("#datatable thead tr").not("#titulosListado").css("display","none");
        filtros = false
      }
      else{
        $("#datatable thead tr").not("#titulosListado").css("display","table-row");
        filtros = true
      }

  }
</script>
 
<script language="javascript">
  var table = $('#datatable').DataTable({
    language: {
      url: "{{=URL('static', 'plugins/datatables/l18n/es-ES.json')}}"
    },
   initComplete: function(){
      var api = this.api();

      new $.fn.dataTable.Buttons(api, {
         buttons: [
            'copy', 'pdf', 'excel', 'csv', 'print'
         ]
      });
      api.buttons().container().appendTo('#buttons');  
   }
  });

  var w2p_ajax_confirm_message =
        "{{=T('')}}";
  
  function abrirFicha(servicio) {
    var x = document.getElementById("serv");
      x.value = servicio;
    ajax('ajax_ficha_servicio', ['serv'], "ficha");
  }

  function getAdscripcion(){
    var opcionessede = document.getElementById("sel6");
    var sedeelegida = opcionessede.options[opcionessede.selectedIndex].value;
    var x = document.getElementById("sede");
      x.value = sedeelegida;
    ajax('ajax_obtener_adscripcion', ['sede'], "adscripciondiv");
  }

  function getDependencia(){
      var opcionesads = document.getElementById("sel4");
      var adselegida = opcionesads.options[opcionesads.selectedIndex].value;
      var x = document.getElementById("adscripcion");
        x.value = adselegida;
      ajax('ajax_obtener_dependencia', ['adscripcion'], "dependenciadiv");

   }

  function getUbicacion(){
      var opcionesdep = document.getElementById("sel3");
      var dependenciaelegida = opcionesdep.options[opcionesdep.selectedIndex].value;
      var x = document.getElementById("dependencia");
        x.value = dependenciaelegida;
      ajax('ajax_obtener_ubicacion', ['dependencia'], "ubicaciondiv");

   }

  function getResponsable(){
      var opcionesdep = document.getElementById("sel3");
      var dependenciaelegida = opcionesdep.options[opcionesdep.selectedIndex].value;
      var x = document.getElementById("dependencia");
        x.value = dependenciaelegida;
      ajax('ajax_obtener_responsable', ['dependencia'], "responsablediv");
   }

  // AJAX EDICION
  function getAdscripcionEdit(){
    var opcionessede = document.getElementById("sel6-edit");
    var sedeelegida = opcionessede.options[opcionessede.selectedIndex].value;
    var x = document.getElementById("sede");
      x.value = sedeelegida;
    ajax('ajax_obtener_adscripcion_editar', ['sede'], "adscripciondiv-edit");
  }

  function getDependenciaEdit(){
      var opcionesads = document.getElementById("sel4-edit");
      var adselegida = opcionesads.options[opcionesads.selectedIndex].value;
      var x = document.getElementById("adscripcion");
        x.value = adselegida;
      ajax('ajax_obtener_dependencia_editar', ['adscripcion'], "dependenciadiv-edit");

   }

  function getUbicacionEdit(){
      var opcionesdep = document.getElementById("sel3-edit");
      var dependenciaelegida = opcionesdep.options[opcionesdep.selectedIndex].value;
      var x = document.getElementById("dependencia");
        x.value = dependenciaelegida;
      ajax('ajax_obtener_ubicacion_editar', ['dependencia'], "ubicaciondiv-edit");

   }

  function getResponsableEdit(){
      var opcionesdep = document.getElementById("sel3-edit");
      var dependenciaelegida = opcionesdep.options[opcionesdep.selectedIndex].value;
      var x = document.getElementById("dependencia");
        x.value = dependenciaelegida;
      ajax('ajax_obtener_responsable_editar', ['dependencia'], "responsablediv-edit");
   }

  function cambiar_estado_detalle_ambito(is_otro_checked, id){
    if (id == 'checkbox_ambito_otro'){
      if (is_otro_checked){
        $("#input_ambito_otro_detalle").show();
      }
      else{
        $("#input_ambito_otro_detalle").hide();
        $("#input_ambito_otro_detalle").val(' ');
      }
    }
    else if (id == 'editar_checkbox_ambito_otro'){
      if (is_otro_checked){
        $("#editar_input_ambito_otro_detalle").show();
      }
      else{
        $("#editar_input_ambito_otro_detalle").hide();
        $("#editar_input_ambito_otro_detalle").val(' ');
        $("#editar_input_ambito_otro_detalle").attr("placeholder", "Otro, Especifique:*");
      }   
    }
    else if (id == 'checkbox_per_otro'){
      if (is_otro_checked){
        $("#input_per_otro_detalle").show();
      }
      else{
        $("#input_per_otro_detalle").hide();
        $("#input_per_otro_detalle").val(' ');
      }      
    }
    else if (id == 'editar_checkbox_per_otro'){
      if (is_otro_checked){
        $("#editar_input_per_otro_detalle").show();
      }
      else{
        $("#editar_input_per_otro_detalle").hide();
        $("#editar_input_per_otro_detalle").val(' ');
        $("#editar_input_per_otro_detalle").attr("placeholder", "Otro, Especifique:*");
      }   
    }
  }

  function cambiar_estado_condicion_ambiental(is_otro_checked, id){
    if (id == 'radio_condicion_ambiental'){
      if (is_otro_checked == "True"){
        $("#input_radio_condicion_ambiental").show();
      }
      else{
        $("#input_radio_condicion_ambiental").hide();
        $("#input_radio_condicion_ambiental").val(' ');
      }
    }
    else if (id == 'editar_radio_condicion_ambiental'){
      if (is_otro_checked == "True"){
        $("#editar_input_radio_condicion_ambiental").show();
      }
      else{
        $("#editar_input_radio_condicion_ambiental").hide();
        $("#editar_input_radio_condicion_ambiental").val(' ');
        $("#editar_input_radio_condicion_ambiental").attr("placeholder", "Si requiere, Especifique:*");
      }   
    }
  }
</script>
{{end}}
